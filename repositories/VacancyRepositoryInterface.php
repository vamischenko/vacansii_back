<?php

namespace app\repositories;

use app\models\Vacancy;
use yii\data\ActiveDataProvider;

/**
 * Интерфейс репозитория вакансий
 *
 * Определяет контракт для всех операций доступа к данным вакансий.
 * Любая реализация репозитория должна следовать этому интерфейсу,
 * обеспечивая единообразный способ работы с данными независимо от
 * конкретной реализации хранилища (SQL, NoSQL, файлы и т.д.).
 *
 * @package app\repositories
 * @author Система управления вакансиями
 * @version 1.0.0
 */
interface VacancyRepositoryInterface
{
    /**
     * Найти вакансию по уникальному идентификатору
     *
     * Выполняет поиск одной вакансии в хранилище данных по её ID.
     * Метод должен возвращать null, если вакансия с указанным ID не найдена.
     *
     * @param int $id Уникальный идентификатор вакансии
     * @return Vacancy|null Модель вакансии если найдена, null если не найдена
     *
     * @throws \Exception Может выбросить исключение при ошибке доступа к хранилищу
     */
    public function findById(int $id): ?Vacancy;

    /**
     * Получить список всех вакансий с пагинацией и сортировкой
     *
     * Возвращает набор вакансий с применением пагинации и сортировки.
     * Реализация должна поддерживать сортировку по полям salary и created_at
     * в порядке возрастания (asc) или убывания (desc).
     *
     * @param int $page Номер страницы для отображения (нумерация начинается с 1)
     * @param string $sortBy Поле для сортировки (допустимые значения: 'salary', 'created_at')
     * @param string $sortOrder Направление сортировки (допустимые значения: 'asc', 'desc')
     * @return ActiveDataProvider Провайдер данных с настроенной пагинацией и сортировкой
     *
     * @throws \InvalidArgumentException Если переданы недопустимые значения параметров
     * @throws \Exception Может выбросить исключение при ошибке доступа к хранилищу
     */
    public function findAll(int $page, string $sortBy, string $sortOrder): ActiveDataProvider;

    /**
     * Сохранить вакансию в хранилище данных
     *
     * Выполняет сохранение модели вакансии. Метод должен автоматически определять,
     * является ли операция созданием новой записи (INSERT) или обновлением
     * существующей (UPDATE). Перед сохранением должна выполняться валидация
     * данных модели согласно определенным правилам.
     *
     * @param Vacancy $vacancy Модель вакансии для сохранения
     * @return bool True если сохранение выполнено успешно, false если произошла ошибка
     *              или модель не прошла валидацию
     *
     * @throws \Exception Может выбросить исключение при критической ошибке сохранения
     */
    public function save(Vacancy $vacancy): bool;

    /**
     * Удалить вакансию из хранилища данных
     *
     * Выполняет удаление вакансии по её уникальному идентификатору.
     * Метод должен возвращать false, если вакансия с указанным ID не существует
     * или не может быть удалена по каким-либо причинам.
     *
     * @param int $id Уникальный идентификатор вакансии для удаления
     * @return bool True если удаление выполнено успешно, false если вакансия не найдена
     *              или удаление не удалось
     *
     * @throws \Exception Может выбросить исключение при критической ошибке удаления
     */
    public function delete(int $id): bool;

    /**
     * Получить общее количество вакансий в хранилище
     *
     * Возвращает общее количество всех записей вакансий без применения
     * каких-либо фильтров или ограничений. Используется для расчетов
     * пагинации, статистики и других операций, требующих знания
     * общего количества элементов.
     *
     * @return int Общее количество вакансий в хранилище (может быть 0)
     *
     * @throws \Exception Может выбросить исключение при ошибке доступа к хранилищу
     */
    public function getTotalCount(): int;

    /**
     * Поиск вакансий по ключевым словам
     *
     * Выполняет полнотекстовый поиск вакансий по названию и описанию.
     * Использует FULLTEXT индекс для эффективного поиска (PostgreSQL tsvector или MySQL FULLTEXT).
     * Результаты ранжируются по релевантности.
     *
     * @param string $query Поисковый запрос (ключевые слова)
     * @param int $page Номер страницы для отображения (нумерация начинается с 1)
     * @param string $sortOrder Направление сортировки (допустимые значения: 'asc', 'desc', 'relevance')
     * @return ActiveDataProvider Провайдер данных с результатами поиска
     *
     * @throws \InvalidArgumentException Если переданы недопустимые значения параметров
     * @throws \Exception Может выбросить исключение при ошибке доступа к хранилищу
     */
    public function search(string $query, int $page, string $sortOrder = 'relevance'): ActiveDataProvider;
}
